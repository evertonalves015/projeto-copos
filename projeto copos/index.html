<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Produ√ß√£o Segundo Turno</title>

  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#0d6efd" />
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    label { display: block; margin-top: 10px; }
    input, button { padding: 8px; font-size: 1em; margin-top: 5px; }
    button { cursor: pointer; background-color: #0d6efd; color: white; border: none; border-radius: 4px; }
    button:hover { background-color: #084aad; }
    #resultado { margin-top: 20px; font-weight: bold; }
  </style>
  <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("sw.js")
        .then(() => console.log("Service Worker registrado com sucesso!"))
        .catch(err => console.error("Erro ao registrar Service Worker:", err));
    }
  </script>
</head>
<body>
  <h2>Calculadora de Produ√ß√£o - Segundo Turno</h2>

  <label for="metaTurno">Meta do segundo turno (copos):</label>
  <input type="number" id="metaTurno" min="1" required />

  <label for="producaoDia">Produ√ß√£o total do dia at√© agora:</label>
  <input type="number" id="producaoDia" min="0" required />

  <label for="primeiroTurno">Produ√ß√£o do primeiro turno:</label>
  <input type="number" id="primeiroTurno" min="0" required />

  <label for="horaAtual">Hor√°rio atual:</label>
  <input type="time" id="horaAtual" required />

  <button onclick="calcular()">Calcular</button>

  <p id="resultado"></p>

  <script>
    function calcular() {
      const metaTurno = parseInt(document.getElementById("metaTurno").value, 10);
      const producaoDia = parseInt(document.getElementById("producaoDia").value, 10);
      const primeiroTurno = parseInt(document.getElementById("primeiroTurno").value, 10);
      const horaAtual = document.getElementById("horaAtual").value;

      if (!metaTurno || isNaN(producaoDia) || isNaN(primeiroTurno) || !horaAtual) {
        document.getElementById("resultado").innerText = "Preencha todos os campos corretamente.";
        return;
      }

      const producaoSegundoTurno = producaoDia - primeiroTurno;
      const faltante = metaTurno - producaoSegundoTurno;

      const [hora, minuto] = horaAtual.split(":").map(Number);
      const minutosAtuais = hora * 60 + minuto;
      const fimTurno = 13 * 60 + 50; // 13:50
      const tempoRestanteMin = fimTurno - minutosAtuais;

      const coposPorMinuto = 170;
      const tempoNecessarioMin = Math.ceil(faltante / coposPorMinuto);
      const horasNecessarias = Math.floor(tempoNecessarioMin / 60);
      const minutosNecessarios = tempoNecessarioMin % 60;

      const horasRestantes = Math.floor(tempoRestanteMin / 60);
      const minutosRestantes = tempoRestanteMin % 60;

      let resultadoHtml = `
        üèÅ Meta do 2¬∫ turno: <strong>${metaTurno.toLocaleString()} copos</strong><br>
        üîÑ Produ√ß√£o do 2¬∫ turno at√© agora: <strong>${producaoSegundoTurno.toLocaleString()} copos</strong><br>
        ‚ùó Falta produzir: <strong>${faltante > 0 ? faltante.toLocaleString() : 0}</strong><br><br>
      `;

      if (faltante <= 0) {
        resultadoHtml += `‚úÖ Meta do turno j√° foi atingida ou ultrapassada!<br>`;
      } else if (tempoRestanteMin <= 0) {
        resultadoHtml += `‚è∞ O turno j√° terminou!<br>`;
      } else {
        resultadoHtml += `
          ‚è±Ô∏è Tempo necess√°rio: <strong>${horasNecessarias}h ${minutosNecessarios}min</strong><br>
          üïí Tempo restante at√© 13:50: <strong>${horasRestantes}h ${minutosRestantes}min</strong><br><br>
          <strong>${tempoNecessarioMin <= tempoRestanteMin
            ? "‚úÖ D√° tempo de bater a meta!"
            : "‚ö†Ô∏è N√£o h√° tempo suficiente para bater a meta neste ritmo."}</strong>
        `;
      }

      document.getElementById("resultado").innerHTML = resultadoHtml;
    }
  </script>
</body>
</html>
